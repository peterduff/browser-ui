<div id="details" class="container g-0">
    <div *ngIf="activeConcept" class="row details g-0">
        <div class="col-12 px-3 pt-3">
            <div class="m-3 rounded-3 concept overflow-hidden">
                <div class="name">
                    <div class="definition-status rounded-circle px-2 me-2">
                        <ng-container *ngIf="activeConcept.definitionStatus === 'FULLY_DEFINED'">
                            <i class="fa-solid fa-bars"></i>
                        </ng-container>
                        <ng-container *ngIf="activeConcept.definitionStatus === 'PRIMITIVE'">
                            &nbsp;
                        </ng-container>
                    </div>
                    <h4 class="d-inline-block p-3 m-0">{{activeConcept.fsn?.term}}</h4>
                    <button class="dots rounded-circle border-0 p-0"><i class="fa-solid fa-ellipsis-vertical p-1"></i></button>
                    <button class="info rounded-circle border-0 p-0"><i class="fa-solid fa-info p-1"></i></button>
                </div>
                <h4 class="sctid px-3 py-2 m-0">
                    <span class="pe-2">SCTID</span>
                    {{activeConcept.conceptId}}
                </h4>
                <h4 class="status px-3 py-2 mb-3">
                    <span class="pe-2">STATUS</span>
                    <ng-container *ngIf="activeConcept.definitionStatus === 'FULLY_DEFINED'">
                        <span class="tag rounded-pill px-3 py-2 me-2">FULLY DEFINED</span>
                    </ng-container>
                    <ng-container *ngIf="activeConcept.definitionStatus === 'PRIMITIVE'">
                        <span class="tag rounded-pill px-3 py-2 me-2">PRIMITIVE</span>
                    </ng-container>
                    <ng-container *ngIf="activeConcept.active">
                        <span class="tag rounded-pill px-3 py-2 me-2 active">ACTIVE</span>
                    </ng-container>
                    <ng-container *ngIf="!activeConcept.active">
                        <span class="tag rounded-pill px-3 py-2 me-2 inactive">INACTIVE</span>
                    </ng-container>
                    <ng-container *ngIf="activeConcept.descendantCount">
                        <span class="tag rounded-pill px-3 py-2 me-2">{{activeConcept.descendantCount}} DESCENDANTS</span>
                    </ng-container>
                </h4>
            </div>
        </div>

        <ng-container *ngIf="referenceSets">
            <div class="col-12 px-3">
                <ng-container *ngFor="let item of calculateMaps(activeConcept) | keyvalue">
                    <div class="m-3 rounded-3 acceptability-map overflow-hidden">
                        <h4 class="px-3 pt-3 mb-0">{{findMap(item.key)?.fsn?.term}}</h4>
                        <div class="row header p-3">
                            <div class="col-8">
                                Term
                            </div>
                            <div class="col-4">
                                Acceptability ({{findMap(item.key)?.pt?.term}})
                            </div>
                        </div>
                        <ng-container *ngFor="let description of activeConcept.descriptions! | active | descriptions:item.key | acceptabilityMap:item.key; let odd = odd">
                            <div class="row p-3" [class.odd]="odd">
                                <div class="col-8">
                                    <span class="type rounded-pill px-2 py-1 me-2" [class.fsn]="description.type === 'FSN'" [class.synonym]="description.type === 'SYNONYM'">{{description.type}}</span>
                                    {{description.term}}
                                </div>
                                <div class="col-4">
                                    {{getAcceptability(description, item.key)}}
                                    <button class="info rounded-circle border-0 p-0">
                                        <i class="fa-solid fa-info p-1"></i>
                                    </button>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </ng-container>
            </div>
        </ng-container>

        <div *ngIf="inferredView && activeConcept.relationships" class="col-12 px-3 pb-3">
            <div class="m-3 rounded-3 axioms overflow-hidden">
                <div class="row header p-3">
                    <div class="col-3">
                        Type
                    </div>
                    <div class="col-6">
                        Destination
                    </div>
                    <div class="col-1">
                        Group
                    </div>
                    <div class="col-2">
                        CharType
                    </div>
                </div>
                <ng-container *ngFor="let relationship of activeConcept.relationships | active | alphabetical:'groupId'; let even = even">
                    <div class="row p-3" [class.even]="even">
                        <div class="col-3">
                            {{relationship.type?.fsn?.term}}
                        </div>
                        <div class="col-6">
                            {{relationship.target?.fsn?.term}}
                        </div>
                        <div class="col-1">
                            {{relationship.groupId}}
                        </div>
                        <div class="col-2">
                            INFERRED
                            <button class="info rounded-circle border-0 p-0">
                                <i class="fa-solid fa-info p-1"></i>
                            </button>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>

        <div *ngIf="!inferredView && activeConcept.classAxioms![0].relationships" class="col-12 px-3 pb-3">
            <div class="m-3 rounded-3 axioms overflow-hidden">
                <h4 class="px-3 pt-3 mb-0">AXIOMS</h4>
                <div class="row header p-3">
                    <div class="col-3">
                        Type
                    </div>
                    <div class="col-6">
                        Destination
                    </div>
                    <div class="col-1">
                        Group
                    </div>
                    <div class="col-2">
                        CharType
                    </div>
                </div>
                <ng-container *ngFor="let relationship of activeConcept.classAxioms![0].relationships | active | alphabetical:'groupId'; let even = even">
                    <div class="row p-3" [class.even]="even">
                        <div class="col-3">
                            {{relationship.type?.fsn?.term}}
                        </div>
                        <div class="col-6">
                            {{relationship.target?.fsn?.term}}
                        </div>
                        <div class="col-1">
                            {{relationship.groupId}}
                        </div>
                        <div class="col-2">
                            STATED
                            <button class="info rounded-circle border-0 p-0">
                                <i class="fa-solid fa-info p-1"></i>
                            </button>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>
    </div>
</div>
